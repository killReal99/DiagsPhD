@startuml "Power System Optimization - Full Architecture"
!theme plain
skinparam {
    BackgroundColor #ffffff
    ArrowColor #2d5f2e
    ClassBackgroundColor #d9e8d9
    ClassBorderColor #2d5f2e
    ClassFontColor #1e3d1f
    InterfaceBackgroundColor #c4dcc4
    InterfaceBorderColor #1e3d1f
    InterfaceFontColor #1e3d1f
    EnumBackgroundColor #b3d6b3
    EnumBorderColor #1e3d1f
    EnumFontColor #1e3d1f
    DefaultFontSize 10
    DefaultFontName Arial
    Shadowing false
}

' ==================== MAIN ENTRY POINT ====================
class Main {
    + main(String[]): void {static}
    - generateResults(): void {static}
}

enum EquipmentType {
    BUS
    LINE
    TRANSFORMER
}

' ==================== CORE CALCULATION CLASSES ====================
class CostsCalculation {
    - capexEquipment: double
    - capexSalary: double
    - opex: double
    + calculateTotalCosts(): double
    + calculateAnnualCosts(): double
}

' ==================== MEASURES CLASSES ====================
class SubstationMeasuresPerYearGeneration {
    - measuresPerYear: Map<Integer, List<SubstationMeasures>>
    + generateMeasuresPerYear(): Map
}

class SubstationMeasures {
    - measureId: String
    - type: String
    - cost: double
    + calculateCost(): double
}

class SubstationMeasuresPerYear {
    - year: int
    - measures: List<SubstationMeasures>
    + getMeasuresForYear(): List<SubstationMeasures>
}

class OrganizationalMeasures {
    - description: String
    - impact: double
    + execute(): void
}

class ImprosedMeasures {
    - measureName: String
    - reliabilityImprovement: double
    + applyMeasure(): void
}

' ==================== COST CLASSES ====================
class CAPEXEquipment {
    - equipmentType: EquipmentType
    - cost: double
    + calculateEquipmentCost(): double
}

class CAPEXSalary {
    - laborCost: double
    - hoursRequired: double
    + calculateSalaryCost(): double
}

class OPEX {
    - maintenanceCost: double
    - operationCost: double
    + calculateAnnualOPEX(): double
}

' ==================== RELATIONSHIPS ====================

' Main dependencies
Main --> CostsCalculation : uses

CostsCalculation --> CAPEXEquipment : uses
CostsCalculation --> CAPEXSalary : uses
CostsCalculation --> OPEX : uses

' Generation classes
SubstationMeasuresPerYearGeneration --> SubstationMeasuresPerYear : generates

' Measures relationships
SubstationMeasures --> OrganizationalMeasures : may_be
SubstationMeasuresPerYear --> SubstationMeasures : contains
OrganizationalMeasures --> ImprosedMeasures : includes

' Cost relationships
CAPEXEquipment --> EquipmentType : uses

@enduml